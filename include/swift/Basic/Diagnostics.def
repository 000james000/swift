//===- Diagnostics.def - Diagnostics Text -----------------------*- C++ -*-===//
//
// This source file is part of the Swift.org open source project
//
// Copyright (c) 2014 - 2015 Apple Inc. and the Swift project authors
// Licensed under Apache License v2.0 with Runtime Library Exception
//
// See http://swift.org/LICENSE.txt for license information
// See http://swift.org/CONTRIBUTORS.txt for the list of Swift project authors
//
//===----------------------------------------------------------------------===//
//
//  This file defines all of the diagnostics that can be emitted by
//  Swift. Each diagnostic is described using one of three
//  kinds--error, warning, or note--along with a unique identifier, category, 
//  options, and text, and is followed by a signature describing the diagnostic
//  argument kinds, e.g., string, identifier, string
//
//===----------------------------------------------------------------------===//

#if !(defined(DIAG) || (defined(ERROR) && defined(WARNING) && defined(NOTE)))
#  error Must define either DIAG or the set {ERROR,WARNING,NOTE}
#endif

#ifndef ERROR
#  define ERROR(ID,Category,Options,Text,Signature)   \
  DIAG(ERROR,ID,Category,Options,Text,Signature)
#endif

#ifndef WARNING
#  define WARNING(ID,Category,Options,Text,Signature) \
  DIAG(WARNING,ID,Category,Options,Text,Signature)
#endif

#ifndef NOTE
#  define NOTE(ID,Category,Options,Text,Signature) \
  DIAG(NOTE,ID,Category,Options,Text,Signature)
#endif

//------------------------------------------------------------------------------
// Parsing diagnostics
//------------------------------------------------------------------------------

ERROR(invalid_diagnostic,parsing,none,
      "INTERNAL ERROR: this diagnostic should not be produced", ())

ERROR(expected_lbrace,parsing,none,
     "to match this opening '{'", ())

NOTE(opening_brace,parsing,none,
     "to match this opening '{'", ())
NOTE(opening_bracket,parsing,none,
     "to match this opening '['", ())
NOTE(opening_paren,parsing,none,
     "to match this opening '('", ())
NOTE(previous_decldef,parsing,none,
     "previous %select{declaration|definition}0 of '%1' is here", 
     (bool, StringRef))
NOTE(previous_declaration,parsing,none,
     "previous declaration of '%0' is here", (StringRef))
NOTE(previous_definition,parsing,none,
     "previous definition of '%0' is here", (StringRef))

//------------------------------------------------------------------------------
// Declaration parsing diagnostics
//------------------------------------------------------------------------------

ERROR(top_level_decl_without_type,decl_parsing,none,
      "top-level declarations require a type specifier", ())
ERROR(expected_identifier_in_decl,decl_parsing,none,
      "expected identifier in %0 declaration", (StringRef))
ERROR(expected_type_or_init,decl_parsing,none,
      "expected a type or an initializer", ())
ERROR(non_simple_var,decl_parsing,none,
      "complex 'var' declaration not allowed here", ())
ERROR(precedence_overload,decl_parsing,none,
      "infix precedence of functions in an overload set must match", ())
ERROR(decl_redefinition,decl_parsing,none,
      "%select{declaration|definition}0 conflicts with previous value", 
      (bool))

// Var Name
ERROR(expected_lparen_var_name,decl_parsing,none,
      "expected identifier or '(' in var name", ())
ERROR(expected_rparen_var_name,decl_parsing,none,
      "expected ')' at end of var name", ())
ERROR(invalid_index_in_var_name_path,decl_parsing,none,
      "%0 is an invalid index for '%1'", (Identifier, StringRef))
      
// Import
ERROR(import_inner_scope,decl_parsing,none,
      "import is only valid at file scope", ())
ERROR(decl_expected_module_name,decl_parsing,none,
      "expected module name in import declaration", ())

// TypeAlias
ERROR(expected_colon_in_typealias,decl_parsing,none,
      "expected ':' in typealias declaration", ())
ERROR(expected_type_in_typealias,decl_parsing,none,
      "expected type in var declaration", ())

// Func
ERROR(func_decl_without_paren,decl_parsing,none,
      "expected '(' in argument list of func declaration", ())

// OneOf

// Struct
ERROR(expected_lbrace_struct,decl_parsing,none,
      "expected '{' in struct", ())
ERROR(expected_rbrace_struct,decl_parsing,none,
      "expected '}' in struct", ())
ERROR(struct_not_tuple,decl_parsing,none,
      "element type of struct is not a tuple", ())

// Protocol

//------------------------------------------------------------------------------
// Type parsing diagnostics
//------------------------------------------------------------------------------

ERROR(expected_type,type_parsing,none,
      "expected type", ())
ERROR(type_redefinition,type_parsing,none,
      "redefinition of type '%0'", (StringRef))
ERROR(expected_identifier_after_coloncolon_type,expr_parsing,none,
      "expected identifier after %0 type", (Identifier))

ERROR(expected_initializer_expr,expr_parsing,none,
      "expected initializer expression after '='", ())

// Function types
ERROR(expected_type_function_result,type_parsing,none,
      "expected type for function result", ())

// OneOf Types
ERROR(expected_lbrace_oneof_type,type_parsing,none,
      "expected '{' in oneof", ())
ERROR(expected_rbrace_oneof_type,type_parsing,none,
      "expected '}' at end of oneof", ())
ERROR(duplicate_oneof_element,type_parsing,none,
      "duplicate definition of element '%0'", (StringRef))
ERROR(expected_type_oneof_element,type_parsing,none,
      "expected type while parsing oneof element", ())

// Array Types      
ERROR(expected_expr_array_type,expr_parsing,none,
      "expected expression for size of array type", ())
ERROR(non_constant_array,type_parsing,none,
      "array has non-constant size", ())
ERROR(zero_length_array,type_parsing,none,
      "array has length zero", ())
ERROR(expected_rbracket_array_type,type_parsing,none,
      "expected ']' in array type", ())
      
// Tuple Types
ERROR(expected_rparen_tuple_type_list,type_parsing,none,
      "expected ')' at end of tuple list", ())

// Protocol Types
ERROR(expected_lbrace_protocol_type,type_parsing,none,
      "expected '{' in protocol type", ())
ERROR(expected_protocol_member,type_parsing,none,
      "expected a function or variable declaration in protocol", ())

//------------------------------------------------------------------------------
// Statement parsing diagnostics
//------------------------------------------------------------------------------
ERROR(expected_stmt,stmt_parsing,none,
      "expected statement", ())

// Assignment statement
ERROR(expected_expr_assignment,stmt_parsing,none,
      "expected expression in assignment", ())

// Brace Statement
ERROR(expected_rbrace_in_brace_stmt,stmt_parsing,none,
      "expected '}' at end of brace statement", ())

// Return Statement
ERROR(expected_expr_return,stmt_parsing,none,
      "expected expresssion in 'return' statement", ())

// If Statement
ERROR(expected_expr_if,stmt_parsing,none,
      "expected expresssion in 'if' condition", ())
ERROR(expected_lbrace_after_if,stmt_parsing,none,
      "expected '{' after 'if' condition", ())
ERROR(expected_lbrace_after_else,stmt_parsing,none,
      "expected '{' after 'else'", ())

// While Statement
ERROR(expected_expr_while,stmt_parsing,none,
      "expected expresssion in 'while' condition", ())
ERROR(expected_lbrace_after_while,stmt_parsing,none,
      "expected '{' after 'while' condition", ())

//------------------------------------------------------------------------------
// Expression parsing diagnostics
//------------------------------------------------------------------------------

ERROR(expected_expr,expr_parsing,none,
      "expected expression", ())

ERROR(expected_expr_after_operator,expr_parsing,none,
      "expected expression after operator", ())

ERROR(expected_single_expr,expr_parsing,none,
      "expected a singular expression", ())
ERROR(expected_field_name,expr_parsing,none,
      "expected field name following '.'", ())
ERROR(expected_dollar_numeric,expr_parsing,none,
      "expected numeric value following '$'", ())
ERROR(dollar_numeric_too_large,expr_parsing,none,
      "numeric value following '$' is too large", ())
ERROR(expected_identifier_after_colon_expr,expr_parsing,none,
      "expected identifier after ':' expression", ())
ERROR(expected_identifier_after_coloncolon_expr,expr_parsing,none,
      "expected identifier after %0' expression", (Identifier))
ERROR(expected_field_spec_name_tuple_expr,expr_parsing,none,
      "expected field specifier name in tuple expression", ())    

// Subscript expressions
ERROR(expected_expr_subscript_value,expr_parsing,none,
      "expected expression for subscript value", ())
ERROR(expected_bracket_array_subscript,expr_parsing,none,
      "expected ']' in subscript expression", ())

// Tuples and parenthesized expressions
ERROR(expected_expr_parentheses,expr_parsing,none,
      "expected subexpression in parentheses", ())
ERROR(expected_equal_in_tuple_expr,expr_parsing,none,
      "expected '=' in tuple expression", ())
ERROR(expected_rparen_parenthesis_expr,expr_parsing,none,
      "expected ')' in parenthesis expression", ())

// Func expressions
ERROR(expected_lbrace_func_expr,decl_parsing,none,
      "expected '{' in func expression", ())


//------------------------------------------------------------------------------
// Literal parsing diagnostics
//------------------------------------------------------------------------------
ERROR(int_literal_too_large,literal_parsing,none,
      "integer constant too large", ())
ERROR(float_literal_multi_decimal,literal_parsing,none,
      "floating point constant contains multiple decimal points", ())
WARNING(float_literal_overflow,literal_parsing,none,
        "floating point constant overflowed to %0", (StringRef))
WARNING(float_literal_underflow,literal_parsing,none,
        "floating point constant underflowed to %0", (StringRef))
      
//------------------------------------------------------------------------------
// Attribute-parsing diagnostics
//------------------------------------------------------------------------------
ERROR(expected_attribute_name,attribute_parsing,none,
      "expected an attribute name", ())
ERROR(unknown_attribute,attribute_parsing,none,
      "unknown attribute '%0'", (StringRef))
ERROR(duplicate_attribute,attribute_parsing,none,
      "duplicate '%0' attribute", (StringRef))
ERROR(expected_in_attribute_list,attribute_parsing,none,
      "expected ']' or ',' in attribute list", ())

// infix and unary      
ERROR(expected_precedence_value,attribute_parsing,none,
      "expected precedence number in infix attribute", ())
ERROR(invalid_precedence,attribute_parsing,none,
      "precedence '%0' is not an integer between 0 and 255", (StringRef))

ERROR(import_attributes,attribute_parsing,none,
      "invalid attributes specified for import", ())
ERROR(oneof_attributes,attribute_parsing,none,
      "oneof types are not allowed to have attributes", ())
ERROR(protocol_attributes,attribute_parsing,none,
      "protocol types are not allowed to have attributes", ())

#if defined(DIAG)
#  undef DIAG
#endif
#undef NOTE
#undef WARNING
#undef ERROR

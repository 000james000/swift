// RUN: %swift -emit-ir -target x86_64-apple-darwin10 %s | FileCheck %s

sil_stage canonical

import Builtin
import Swift

class X {
}

sil @_TFC8metatype1Xd : $@cc(method) @thin (@owned X) -> @owned Builtin.ObjectPointer

sil @_TFC8metatype1XD : $@cc(method) @thin (@owned X) -> ()

// CHECK-LABEL: define %objc_class* @_TF8metatype22thick_to_objc_metatypeFT2xmMCS_1X_T_(%swift.type*)
sil @_TF8metatype22thick_to_objc_metatypeFT2xmMCS_1X_T_ : $@thin (@thick X.metatype) -> @objc_metatype X.metatype {
bb0(%0 : $@thick X.metatype):
  // CHECK: [[RESULT:%[0-9a-zA-Z_-]+]] = bitcast %swift.type* %0 to %objc_class*
  %1 = thick_to_objc_metatype %0 : $@thick X.metatype to $@objc_metatype X.metatype
  // CHECK-NEXT: ret %objc_class* [[RESULT]]
  return %1 : $@objc_metatype X.metatype
}

// CHECK-LABEL: define %swift.type* @_TF8metatype22objc_to_thick_metatypeFT2xmMCS_1X_T_(%objc_class*)
sil @_TF8metatype22objc_to_thick_metatypeFT2xmMCS_1X_T_ : $@thin (@objc_metatype X.metatype) -> @thick X.metatype {
bb0(%0 : $@objc_metatype X.metatype):
  // CHECK: [[RESULT:%[0-9a-zA-Z_-]+]] = call %swift.type* @swift_getObjCClassMetadata(%objc_class* %0) #0
  %1 = objc_to_thick_metatype %0 : $@objc_metatype X.metatype to $@thick X.metatype
  // CHECK-NEXT: ret %swift.type* [[RESULT]]
  return %1 : $@thick X.metatype
}
